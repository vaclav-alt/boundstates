set samples 10000

Vfile = "V0_interpolated.dat"
Efile = "energies.dat"
Wftmpl = "wf%03d.dat"
N = 50

Wfile(i) = sprintf(Wftmpl, i)

load Efile

wfscale = 500

# set xrange [1.7:10]
# set yrange [-0.2:0.01]

plot Vfile u 1:2 w l lw 1.5 lc black, \
	for [i=1:N] Vfile u 1:(($2 > E[i]) ? 1/0 : E[i]) notitle w l lc rgb "#A0A0A0", \
	for [i=1:N] Wfile(i-1) u 1:(($2**2 + $3**2)/wfscale+E[i]) notitle w l 
